{% extends 'base_dar.html' %}

{% load deputags %}
{% load dartags %}

{% block extrascripts %}
<script type="text/javascript" src="/media/js/highcharts.js"></script>
<script type="text/javascript" src="/media/js/themes/gray.js"></script>

<!-- Gráfico - Proporção de intervenções -->
<script type="text/javascript">
  var chart;
  $(document).ready(function() {
    chart = new Highcharts.Chart({
      chart: {
        renderTo: 'grafproporcao',
        plotBackgroundColor: null,
        plotBorderWidth: null,
        plotShadow: false,
      },
      title: {
        text: ''
      },
      tooltip: {
        formatter: function() {
          return '<b>'+ this.point.name +'</b>: '+ this.y +' %';
        }
      },
      plotOptions: {
        pie: {
          allowPointSelect: true,
          cursor: 'pointer',
          size: '100%',
          dataLabels: {
             enabled: false,
             color: '#000000',
             connectorColor: '#000000',
             formatter: function() {
               return '<b>'+ this.point.name +'</b>: '+ this.y +' %';
             }
          }
        }
      },
      series: [{
        type: 'pie',
        name: 'Partidos',
        size: '15%',
        innerSize: '70%',
        data: [
        {% for party in party_counts %}
          { name: '{{ party|upper }}',     y: {{ party_counts|lookup:party|lookup:"total"|floatise }},    color: '{{ party_colors|lookup:party }}', },
        {% endfor %}
        ]},
        {
        type: 'pie',
        name: 'Deputados',
        innerSize: '70%',
        data: [
        {% for party in party_counts %} 
          {% for speaker in party_counts|lookup:party %}
          {% if not speaker == 'total' %}
          { name: '{{ speaker }}',     y: {{ party_counts|lookup:party|lookup:speaker|floatise }},    color: '{{ party_colors|lookup:party }}', },  
          {% endif %}
          {% endfor %}
        {% endfor %}
        ]}],
    });
  });
</script>

<!-- Gráfico - Muito bem! -->
<script type="text/javascript">
  var chart;
  $(document).ready(function() {
    chart = new Highcharts.Chart({
      chart: {
        renderTo: 'grafmuitobem',
        defaultSeriesType: 'column',
        margin: [10, 10, 10, 10]
      },
      title: {
        text: ''
      },
      xAxis: {
        labels: { enabled: false },
        tickWidth: 0,
        lineWidth: 0,
        minorGridLineWidth: 0,
      },
      yAxis: {
        labels: { enabled: false },
        tickWidth: 0,
        lineWidth: 0,
        minorGridLineWidth: 0,
        min: 0,
        title: {
          text: ''
        }
      },
      legend: {
        enabled: false
      },
      tooltip: {
        formatter: function() {
          return '<b>'+ this.point.name +'</b><br/>'+
             '...disse "Muito bem!" um total de '+ Highcharts.numberFormat(this.y, 0) +
             ' vezes.';
        }
      },
      series: [{
        name: 'Muito bem!',

        data: [
         {% if mb_counts.ps %}{ name: 'PS',    y: {{ mb_counts.ps}},    color: '#d888bb', },{% endif %}
         {% if mb_counts.psd %}{ name: 'PSD',    y: {{ mb_counts.psd}},   color: '#cb8d41', },{% endif %}
         {% if mb_counts.cdspp %}{ name: 'CDS-PP', y: {{ mb_counts.cdspp}}, color: '#606798', },{% endif %}
         {% if mb_counts.be %}{ name: 'BE',     y: {{ mb_counts.be}},    color: '#671717', },{% endif %}
         {% if mb_counts.pcp %}{ name: 'PCP',    y: {{ mb_counts.pcp}},   color: '#c74343', },{% endif %}
          {% if mb_counts.pev %}{ name: 'PEV',    y: {{ mb_counts.pev}},   color: '#607454', },{% endif %}
        ],
        dataLabels: {
          enabled: true,
          rotation: -90,
          color: '#FFFFFF',
          align: 'right',
          x: -8,
          y: 10,
          formatter: function() {
            return this.y;
          },
          style: {
            font: 'normal 11px Verdana, sans-serif'
          }
        }			
      }]
    });
  });
</script>

{% endblock %}

{% block extrabodyclass %}default dar{% endblock %}

{% block content %}
    <div id="content-box">
      
      <ul id="dar-tabs" class="tabs">
        <li><a href="/dar/{{ day.id }}" title="">Sessão</a></li>
        <li><span>Estatísticas</span></li>
      </ul>
       
      <h2 class="ribbon">{{ day.date }}</h2>
      
      <div id="multi-col">
        <div class="col">
          <h3>Proporção das intervenções</h3>
          <div id="grafproporcao" style="width: 290px; height: 290px; margin: 0 auto"></div>
        </div>
        
        <div class="col">
          <h3>Muito bem!</h3>
          <div id="grafmuitobem" style="width: 290px; height: 290px; margin: 0 auto"></div>
        </div>
        
        <div class="col">
          <h3>Considerações parvas</h3>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque ultricies accumsan metus in adipiscing. Cras tincidunt metus ac massa mattis sagittis. Quisque fringilla congue porttitor. Nam pharetra lobortis lorem quis.</p>
        </div>
        
      </div> <!-- /#multi-col -->
        
    </div><!-- /#content-box -->
{% endblock content %}
      
